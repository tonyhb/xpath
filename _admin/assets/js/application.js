// Generated by CoffeeScript 1.3.3
(function() {
  var App, ContextMenu;

  App = function() {};

  App.prototype.init = function(options) {
    if (options) {
      this.context = options.context;
      $(this.context).height(($(window).height() - 60) + 'px');
    } else {
      this.context = document;
    }
    this.contextMenu = new ContextMenu(this.context);
    document.body.addEventListener('contextmenu', _.bind(this.mouseDown, this));
    return frames['page_iframe'].document.body.addEventListener('contextmenu', _.bind(this.mouseDown, this));
  };

  App.prototype.mouseDown = function(event) {
    if (event.which === 3 || event.button === 2) {
      this.contextMenu.process(event.target);
      event.preventDefault();
      return false;
    }
  };

  ContextMenu = function(context) {
    this.context = context;
    this.container = document.createElement('div');
    $(this.context).contents().find("body").append(this.container);
    return this;
  };

  ContextMenu.prototype.elementContextMenus = {
    'H1|H2|H3|H4|H5|H6|P|A|SPAN': 'textBlock'
  };

  ContextMenu.prototype.process = function(element) {
    var elements, methodName, _ref, _results;
    _ref = this.elementContextMenus;
    _results = [];
    for (elements in _ref) {
      methodName = _ref[elements];
      elements = elements.split('|');
      if (elements.indexOf(element.tagName) >= 0) {
        this[methodName].call(this, element);
        break;
      } else {
        _results.push(void 0);
      }
    }
    return _results;
  };

  ContextMenu.prototype.textBlock = function(element) {};

  window.App = new App();

  document.getElementById('page_iframe').onload = _.bind(window.App.init, window.App, {
    context: $('#page_iframe')
  });

}).call(this);
